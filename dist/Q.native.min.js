/*!
 * Q.js v0.2.2
 * Inspired from vue.js
 * (c) 2015 Daniel Yang
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):"object"==typeof exports?exports.Q=e():t.Q=e()}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return t[n].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){var n=i(1),s=i(3),r=i(2);s.extend(n,s),t.exports=r(n)},function(t){var e=function(){},i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||setTimeout;t.exports={slice:[].slice,noop:e,addClass:function(t,e){if(t.classList)t.classList.add(e);else{var i=" "+(t.getAttribute("class")||"")+" ";i.indexOf(" "+e+" ")<0&&t.setAttribute("class",trim(i+e))}},removeClass:function(t,e){if(t.classList)t.classList.remove(e);else{for(var i=" "+(t.getAttribute("class")||"")+" ",n=" "+e+" ";i.indexOf(n)>=0;)i=i.replace(n," ");t.setAttribute("class",trim(i))}},through:function(t){return t},warn:function(){return window.console&&console.error?function(t){console.error(t)}:e},isObject:function(t){return"object"==typeof t},nextTick:function(t,e){e?i(function(){t.call(e)},0):i(t,0)}}},function(t,e,i){t.exports=function(t){function e(e){return t.contains(o.documentElement,e)}function n(t){this._init(t)}var s=i(4),r=i(5).mergeOptions,a=i(6),o=document;return n.options={directives:i(7)},n.get=function(e){var i=t.find(e)[0];return i?t.data(i,"QI"):new this({el:e})},n.all=function(e){var i=this;return t.find(e.el).map(function(n){return new i(t.extend(e,{el:n}))})},t.extend(n,a),t.extend(n.prototype,{_init:function(e){e=e||{},this.$el=e.el&&"string"==typeof e.el?t.find(e.el)[0]:e.el,this.$$={},e=this.$options=r(this.constructor.options,e,this),this._isCompiled=!1,this._isAttached=!1,this._isReady=!1,this._events={},this._watchers={},this._children=[],this.$={},s.call(this,e),this._initScope(),this._callHook("created"),this.$el&&(t.data(this.$el,"QI",this),this.$mount(this.$el))},data:function(t,e){if(void 0===t)return this;var i,n=0,s=this;if(~t.indexOf(".")){var r=t.split(".");for(i=r.length;i-1>n;n++)t=r[n],+t+""===t&&(t=+t),s=s[t]}return i&&(t=r[n]),void 0===e?t?s[t]:s:void s.$set(t,e)},$on:function(t,e){return(this._events[t]||(this._events[t]=[])).push(e),this},$once:function(t,e){function i(){n.$off(t,i),e.apply(this,arguments)}var n=this;return i.fn=e,this.$on(t,i),this},$off:function(t,e){var i,n,s;if(!arguments.length)return this._events={},this;if(i=this._events[t],!i)return this;if(1===arguments.length)return this._events[t]=null,this;for(s=i.length;s--;)if(n=i[s],n===e||n.fn===e){i.splice(s,1);break}return this},$watch:function(t,e,i,n){var s=i?t+"**deep**":t;return(this._watchers[s]||(this._watchers[s]=[])).push(e),n&&e(this.data(t)),this},$emit:function(e){if(this._emit.apply(this,arguments),0===e.indexOf("data:")){var i=t.slice.call(arguments,1);i.unshift(e.substring(5)),this._callDataChange.apply(this,i)}return this},_emit:function(e){var i=this._events[e];if(i){for(var n=arguments.length-1,s=new Array(n);n--;)s[n]=arguments[n+1];n=0,i=i.length>1?t.slice.call(i,0):i;for(var r=i.length;r>n;n++)i[n].apply(this,s)}},_clearWatch:function(t){t+=".";var e;for(e in this._watchers)~e.indexOf(t)&&(this._watchers[e].length=0)},_callDataChange:function(e){var e,i=e.split("."),n={_events:this._watchers},r=t.slice.call(arguments,1),a=this._emit;r.unshift(e),r[1]instanceof s&&"length"in r[1]&&this._clearWatch(e),a.apply(n,r);for(;i.length>0;)e=i.join("."),r[0]=e+"**deep**",r[1]=this.data(e),a.apply(n,r),i.pop();a.apply(n,["**deep**",this])},_initScope:function(){this._initMethods()},_initMethods:function(){var t,e=this.$options.methods;if(e)for(t in e)this[t]=e[t].bind(this)},$mount:function(i){return this._isCompiled?t.warn("$mount() should be called only once"):(this._compile(i),this._isCompiled=!0,this._callHook("compiled"),void(e(this.$el)?(this._callHook("attached"),this._ready()):this.$once("hook:attached",this._ready)))},_ready:function(){this._isAttached=!0,this._isReady=!0,this._callHook("ready")},_compile:function(t){this.transclue(t,this.$options)},transclue:function(e,i){t.find(".q-mark",e).length?this._renderedBind(e,i):this._templateBind(e,i)},_templateBind:i(8),_renderedBind:function(){},_callHook:function(t){var e=this.$options[t];if(e)for(var i=0,n=e.length;n>i;i++)e[i].call(this);this.$emit("hook:"+t)},_makeReadFilters:function(e){if(!e.length)return[];var i=this.$options.filters,n=this;return e.map(function(e){var s,r=e.split(" ");return e=r.shift(),s=i[e]?i[e].read||i[e]:t.through,function(t){return r?s.apply(n,[t].concat(r)):s.call(n,t)}})},applyFilters:function(t,e,i){if(!e||!e.length)return t;for(var n=0,s=e.length;s>n;n++)t=e[n].call(this,t,i);return t}}),t.extend(n.prototype,s.prototype),n}},function(t){var e=function(t,e){e=[].splice.call(arguments,1);for(var i,n,s=0,r=e.length;r>s;s++){i=e[s];for(n in i)t[n]=i[n]}return t},i="QDataUid",n=0,s={};t.exports={find:function(t){return this.slice.call(document.querySelectorAll(t),0)},contains:function(t,e){return t!==e&&t.contains(e)},data:function(t,e,r){var a=t[i]=t[i]||++n,o=s[a]=s[a]||{};return void 0===r?o[e]:o[e]=r},cleanData:function(t){t.forEach(function(t){var e=t[i];e&&e in s&&delete s[e]})},add:function(t,e,i){t.addEventListener(e,i,!1)},remove:function(t,e,i){t.removeEventListener(e,i,!1)},clone:function(t){return t.cloneNode(!0)},extend:function(t){return 1===arguments.length?e(this,t):e.apply(this,arguments)}}},function(t,e,i){function n(t,e,i){+e+""===e&&(e=+e);var n={data:i,up:t,top:t._top,namespace:[t._namespace,e].join(".")};t[e]="object"==typeof i&&null!==i?s(i)?new a(n):new r(n):i}function s(t){return Array.isArray(t)||t instanceof a}function r(t){var e=t.data,i=Object.keys(t.data||{}).filter(function(t){return 0!==t.indexOf("_")}),s=this;o.extend(this,e),this._keys=i,this._up=t.up,this._top=t.top||this,this._namespace=t.namespace||"",i.forEach(function(t){n(s,t,e[t])}),Array.isArray(e)?this.length=i.length:e instanceof a&&(this.length=i.length-1)}function a(t){r.call(this,t)}var o=i(1);o.extend(r.prototype,{$namespace:function(t){return(void 0!==t?[this._namespace,t].join("."):this._namespace).substring(1)},$set:function(t,e){return n(this,t,e),this._top.$emit("data:"+this.$namespace(t),this[t]),this},$get:function(){var t,e=this._keys,i=this;return t=this instanceof r?{}:[],e.forEach(function(e){t[e]=i[e].$get?i[e].$get():i[e]}),t}}),o.extend(a.prototype,r.prototype,{push:function(t){return n(this,this.length,t),this._keys.push(this.length),this.length++,this._top.$emit("data:"+this.$namespace(),this),this},pop:function(){var t=this[--this.length];return this[this.length]=null,delete this[this.length],this._keys.pop(),this._top.$emit("data:"+this.$namespace(),this),t},unshift:function(t){this._keys.push(this.length),this.length++;for(var e=this.length;e--;)this[e]=this[e-1];return n(this,0,t),this._top.$emit("data:"+this.$namespace(),this),this},shift:function(){this.length--;for(var t=this[0],e=0,i=this.length;i>e;e++)this[e]=this[e+1];return this._keys.pop(),this._top.$emit("data:"+this.$namespace(),this),t},touch:function(t){this._top.$emit("data:"+this.$namespace(t),this)},indexOf:function(t){for(var e=0,i=this.length;i>e;e++)if(this[e]===t)return e;return-1},splice:function(t,e){for(var i=0,n=e+t,s=this.length-e;s>t;t++,i++)this[t]=this[n+i],this[t]._namespace=this[t]._namespace.replace(/\.(\d+?)$/,"."+t);for(;t<this.length;t++)this[t]=null,delete this[t];this.length-=e,this._keys.splice(this.length,e),this._top.$emit("data:"+this.$namespace(),this)},forEach:function(t){for(var e=0,i=this.length;i>e;e++)t(this[e],e)},filter:function(t){var e=[];return this.forEach(function(i){t(i)&&e.push(i)}),e}}),t.exports=r},function(t,e,i){function n(t,e,i){function n(n){var s=r[n]||a;o[n]=s(t[n],e[n],i,n)}var s,o={};for(s in t)n(s);for(s in e)t.hasOwnProperty(s)||n(s);return o}var s=i(1),r={};r.created=r.ready=r.attached=r.detached=r.compiled=r.beforeDestroy=r.destroyed=r.paramAttributes=function(t,e){return e?t?t.concat(e):Array.isArray(e)?e:[e]:t},r.methods=r.directives=function(t,e){return e?t?s.extend({},t,e):e:t};var a=function(t,e){return void 0===e?t:e};t.exports={strats:r,mergeOptions:n}},function(t,e,i){function n(t,e){var i=o[t]=this.extend(e||{});return i}function s(t){return o[t]||this}function r(t){t=t||{};var e=this,i=a(t.name||"QComponent");return i.prototype=Object.create(e.prototype),i.prototype.constructor=i,i.options=h(e.options,t),i["super"]=e,i.extend=e.extend,i.get=e.get,i.all=e.all,i}function a(t){return new Function("return function "+t+" (options) { this._init(options) }")()}var o={},h=i(5).mergeOptions;t.exports={define:n,require:s,extend:r}},function(t,e,i){var n=i(1);t.exports={show:function(t){var e=this.el;e.style.display=t?"block":"none"},"class":function(t){var e=this.el,i=this.arg;t?n.addClass(e,i):n.removeClass(e,i)},value:function(t){var e=this.el;"checkbox"===e.type?e.checked=t:e.value=t},text:function(t){void 0!==t&&(this.el.innerText=t)},on:{bind:function(){var t=this.target||this.exp.match(/^[\w\-]+/)[0],e=this.exp,i=this.filters,s=this.vm,r=s.applyFilters(this.vm[t],i),a=this.namespace?s.data(this.namespace):s;n.add(this.el,this.arg,function(){return r&&"function"==typeof r?void(e?r.call(s,a):r.apply(s,arguments)):n.warn("You need implement the "+t+" method.")})}},model:{bind:function(){var t=this.target,e=this.namespace||"",i=this.el,s=this.vm;n.add(i,"input onpropertychange change",function(){s.data(e).$set(t,i.value)})},update:function(t){this.el.value=t}},vm:{bind:function(){this.el.removeAttribute("q-vm"),this.setting.stop=!0;var t=this.target,e=this.vm,i=this.el,n=i.getAttribute("q-ref")||!1,s=i.getAttribute("q-with")||"",r=this.namespace,a=r?[r,s].join("."):s,o=e.data(a),h=new(e.constructor.require(t))({el:i,data:o.$get()});e._children.push(h),n&&!function(){var t=e.$[n];t?t.length?t.push(h):e.$[n]=[t,h]:e.$[n]=h}(),e.$watch(a,function(t){e.$set(s,t)},!0,!1)}}}},function(t,e,i){function n(t,e,i){var s,r,h,c,u,l,f;for(s=0;c=t[s++];){if(1===c.nodeType){if(i.useCache&&(f=c.getAttribute("qtid"))&&(l=a.get(f)))c.removeAttribute("qtid");else{for(u=c.attributes,h=u.length,l=[],r=0;h>r;r++)0===u[r].name.indexOf("q-")&&l.push({name:u[r].name,value:u[r].value});i.useCache&&!f&&(f=f||++o,c.setAttribute("qtid",f),a.put(f,l))}l.length>0&&e(c,l,i)}c.childNodes.length&&!i.stop&&n(c.childNodes,e,i),i.stop=!1}}var s=i(9),r=i(1),a=new(i(10))(1e3),o=0;t.exports=function(t,e){e=e||{};var i=this,a=i.$options.directives,o=(e.index,e.data||i),h=e.namespace;n([t],function(t,c,u){c.forEach(function(c){var l=c.name.substring(2),f=a[l],p=s(c.value);f&&p.forEach(function(n){var s=i._makeReadFilters(n.filters),a=n.target,c=h?[h,a].join("."):a,l=r.isObject(f)?f.update:f,p=r.extend({el:t,vm:i,namespace:h,setting:u},n,{filters:s});l&&i.$watch(c,function(t){t=i.applyFilters(t,s),l.call(p,t)},"object"==typeof o[a],e.immediate||void 0!==o[a]),r.isObject(f)&&f.bind&&f.bind.call(p)}),"repeat"===l&&t.parentNode&&!u.unrepeat&&(u.unrepeat=!0)&&p.forEach(function(e){var s=e.target,a=h?[h,s].join("."):s,o=i._makeReadFilters(e.filters),c=[],u=t,l=document.createComment("q-repeat"),f=t.parentNode;f.replaceChild(l,u),n([u],r.noop,{useCache:!0,unrepeat:!0}),o.push(function(t){c.length&&(c.forEach(function(t){t.parentNode===f&&f.removeChild(t)}),r.cleanData(c),c.length=0);var e,n=document.createDocumentFragment();t.forEach(function(t){e=r.clone(u),i._templateBind(e,{data:t,namespace:t.$namespace(),immediate:!0,useCache:!0}),c.push(e),n.appendChild(e)}),f.insertBefore(n,l)}),i.$watch(a,function(t){r.nextTick(function(){i.applyFilters(t,o),i.$emit("repeat-render")})},!1,!0)})})},{useCache:e.useCache})}},function(t,e,i){function n(t){var e=s.get(t);if(e)return e;var i=t.trim().split(/ *\, */),n=/^([\w\-]+)\:/,r=/^[\w\-]+$/,a=[];return i.forEach(function(t){var e,t,i={},s=t.match(n);s&&(i.arg=s[1],t=t.substring(s[0].length).trim()),e=t.split(/ *\| */),t=e.shift(),r.test(t)?i.target=t:i.exp=t,i.filters=e,a.push(i)}),s.put(t,a),a}var s=new(i(10))(1e3);t.exports=n},function(t){function e(t){this.size=0,this.limit=t,this.head=this.tail=void 0,this._keymap={}}var i=e.prototype;i.put=function(t,e){var i={key:t,value:e};return this._keymap[t]=i,this.tail?(this.tail.newer=i,i.older=this.tail):this.head=i,this.tail=i,this.size===this.limit?this.shift():void this.size++},i.shift=function(){var t=this.head;return t&&(this.head=this.head.newer,this.head.older=void 0,t.newer=t.older=void 0,this._keymap[t.key]=void 0),t},i.get=function(t,e){var i=this._keymap[t];if(void 0!==i)return i===this.tail?e?i:i.value:(i.newer&&(i===this.head&&(this.head=i.newer),i.newer.older=i.older),i.older&&(i.older.newer=i.newer),i.newer=void 0,i.older=this.tail,this.tail&&(this.tail.newer=i),this.tail=i,e?i:i.value)},t.exports=e}])});